---
// Conversation Preview - shows AI handling a real guest query
---

<section id="see-it-work" class="py-24 px-6">
  <div class="max-w-5xl mx-auto">
    <h2 class="animate-on-scroll text-3xl sm:text-4xl font-bold text-center mb-4">
      See Jack in action
    </h2>
    <p class="animate-on-scroll text-neutral-600 dark:text-neutral-400 text-center mb-12 max-w-2xl mx-auto">
      Real conversations. Instant responses. Happy guests.
    </p>

    <div class="max-w-2xl mx-auto">
      <!-- Chat Window -->
      <div class="scale-in rounded-2xl border border-neutral-200 dark:border-neutral-700 bg-white dark:bg-neutral-900 overflow-hidden shadow-xl dark:shadow-[0_0_60px_-15px_rgba(59,130,246,0.5)]">
        <!-- Chat Header -->
        <div class="px-4 py-3 bg-neutral-900 dark:bg-neutral-100 border-b border-neutral-800 dark:border-neutral-200 flex items-center gap-3">
          <div class="w-3 h-3 rounded-full bg-emerald-500"></div>
          <span class="text-sm font-medium text-white dark:text-neutral-900">WhatsApp · Guest Chat</span>
        </div>

        <!-- Messages -->
        <div id="chat-messages" class="p-4 space-y-4">
          <!-- Guest Message 1 -->
          <div class="chat-message opacity-0 translate-y-4 flex justify-start">
            <div class="max-w-[80%] px-4 py-2 rounded-2xl rounded-bl-md bg-neutral-700 dark:bg-neutral-700">
              <p class="text-sm text-white">Hi! What time is check-in? And do you have parking?</p>
              <span class="text-xs text-neutral-400 mt-1 block">2:47 AM</span>
            </div>
          </div>

          <!-- Jack Response 1 -->
          <div class="chat-message opacity-0 translate-y-4 flex justify-end">
            <div class="max-w-[80%] px-4 py-2 rounded-2xl rounded-br-md bg-blue-600 text-white">
              <p class="text-sm">Hello! Check-in is from 3:00 PM, and early check-in is available upon request (subject to availability).</p>
              <p class="text-sm mt-2">Yes, we have free on-site parking for all guests. Just pull up to the main entrance and our team will direct you.</p>
              <p class="text-sm mt-2">Is there anything else I can help you with?</p>
              <span class="text-xs text-blue-200 mt-1 block">2:47 AM · via Jack</span>
            </div>
          </div>

          <!-- Guest Message 2 -->
          <div class="chat-message opacity-0 translate-y-4 flex justify-start">
            <div class="max-w-[80%] px-4 py-2 rounded-2xl rounded-bl-md bg-neutral-700 dark:bg-neutral-700">
              <p class="text-sm text-white">Perfect! Can I also get a late checkout on Sunday?</p>
              <span class="text-xs text-neutral-400 mt-1 block">2:48 AM</span>
            </div>
          </div>

          <!-- Jack Response 2 -->
          <div class="chat-message opacity-0 translate-y-4 flex justify-end">
            <div class="max-w-[80%] px-4 py-2 rounded-2xl rounded-br-md bg-blue-600 text-white">
              <p class="text-sm">I'd be happy to arrange that! I've noted your late checkout request for Sunday. Our front desk will confirm availability when you check in.</p>
              <p class="text-sm mt-2">See you soon!</p>
              <span class="text-xs text-blue-200 mt-1 block">2:48 AM · via Jack</span>
            </div>
          </div>
        </div>

        <!-- Typing Indicator -->
        <div id="typing-indicator" class="px-4 pt-2 pb-4 opacity-0">
          <div class="inline-flex items-center gap-2 px-3 py-2 rounded-full bg-neutral-700 dark:bg-neutral-700 text-xs text-white">
            <span class="flex gap-1 items-center">
              <span class="typing-dot w-1.5 h-1.5 rounded-full bg-neutral-400"></span>
              <span class="typing-dot w-1.5 h-1.5 rounded-full bg-neutral-400" style="animation-delay: 200ms"></span>
              <span class="typing-dot w-1.5 h-1.5 rounded-full bg-neutral-400" style="animation-delay: 400ms"></span>
            </span>
            Jack is typing...
          </div>
        </div>
      </div>

      <!-- Caption -->
      <div class="text-center mt-6">
        <p id="chat-caption" class="inline-flex text-sm text-neutral-100 dark:text-neutral-900 px-4 py-2 rounded-full bg-neutral-900 dark:bg-neutral-100 opacity-0 transition-opacity duration-500">
          2:47 AM. Guest got instant answers. Staff slept peacefully.
        </p>
      </div>
    </div>
  </div>
</section>

<style>
  .chat-message {
    transition: opacity 0.4s ease-out, transform 0.4s ease-out;
  }
  .chat-message.is-visible {
    opacity: 1;
    transform: translateY(0);
  }
  #typing-indicator {
    transition: opacity 0.3s ease-out;
  }
  #typing-indicator.is-visible {
    opacity: 1;
  }

  .typing-dot {
    animation: typingWave 1.2s ease-in-out infinite;
  }

  @keyframes typingWave {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-4px);
    }
  }
</style>

<script>
  const chatContainer = document.getElementById('chat-messages');
  const typingIndicator = document.getElementById('typing-indicator');
  const caption = document.getElementById('chat-caption');

  if (chatContainer && typingIndicator) {
    const messages = chatContainer.querySelectorAll('.chat-message');
    let hasAnimated = false;

    const animateChat = () => {
      if (hasAnimated) return;
      hasAnimated = true;

      // Timing: guest messages appear faster, Jack's responses have a slight "thinking" delay
      const delays = [0, 800, 2200, 3000]; // ms delays for each message

      messages.forEach((msg, i) => {
        setTimeout(() => {
          msg.classList.add('is-visible');
        }, delays[i]);
      });

      // Show typing indicator after all messages
      setTimeout(() => {
        typingIndicator?.classList.add('is-visible');
      }, delays[delays.length - 1] + 800);

      // Show caption after typing indicator
      setTimeout(() => {
        caption?.classList.add('opacity-100');
      }, delays[delays.length - 1] + 1200);
    };

    // Trigger when chat window comes into view
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          animateChat();
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.3 });

    observer.observe(chatContainer);
  }
</script>
